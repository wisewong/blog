<!DOCTYPE html>
<html >
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>T-SQL 查询、修改数据表 | Sage Wong</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="T-SQL修改表数据 
INSERT语句 
语法： 
INSERT[TOP(expression) [PERCENT]][INTO]{  | rowset_function_limited[ WITH ( &amp;lt;Table_Hint_Limited&amp;gt; [ …n ] ) ] /指定表提示/| view_name } /视图名/{[(column_list) ] /指定列名/[ ]{VALUE">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="T-SQL 查询、修改数据表 | Sage Wong">
    <meta name="twitter:description" content="T-SQL修改表数据 
INSERT语句 
语法： 
INSERT[TOP(expression) [PERCENT]][INTO]{  | rowset_function_limited[ WITH ( &amp;lt;Table_Hint_Limited&amp;gt; [ …n ] ) ] /指定表提示/| view_name } /视图名/{[(column_list) ] /指定列名/[ ]{VALUE">

    <meta property="og:type" content="article">
    <meta property="og:title" content="T-SQL 查询、修改数据表 | Sage Wong">
    <meta property="og:description" content="T-SQL修改表数据 
INSERT语句 
语法： 
INSERT[TOP(expression) [PERCENT]][INTO]{  | rowset_function_limited[ WITH ( &amp;lt;Table_Hint_Limited&amp;gt; [ …n ] ) ] /指定表提示/| view_name } /视图名/{[(column_list) ] /指定列名/[ ]{VALUE">

    
    <meta name="author" content="sage wong">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/avatar-small.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="Sage Wong" href="/atom.xml">
    

    <link rel="canonical" href="http://yoursite.com/2016/03/02/T-SQL 查询、修改数据表/"/>

                 
</head>

<body class="home-template no-js">
    <script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/bkc.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 Sage Wong 的主页"><img src="/images/touxiang.jpg" width="80" alt="Sage Wong logo" class="panel-cover__logo logo"></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for Sage Wong">Sage Wong</a></h1>
        
        <hr class="panel-cover__divider">
        <p class="panel-cover__description"></p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="Visit the blog" class="blog-button">Blog</a></li>
            
              <li class="navigation__item"><a href="/aboutme">关于我</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="https://weibo.com/z941030" title="Weibo" target="_blank">
      <i class="social fa fa-weibo"></i>
      <span class="label">Weibo</span>
    </a>
  </li> 


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/wisewong" title="GitHub" target="_blank">
      <i class="social fa fa-github"></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  <li class="navigation__item">
    <a href="https://twitter.com/mr_xlz" title="Twitter" target="_blank">
      <i class="social fa fa-twitter"></i>
      <span class="label">Twitter</span>
    </a>
  </li>

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class="social fa fa-rss"></i>
      <span class="label">RSS</span>
    </a>
  </li>



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-disabled"></div>
  </div> 
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2016-03-02T15:13:34.000Z" class="post-list__meta--date date">2016-03-02</time> &#8226; <span class="post-meta__tags tags">于  </span>
      <span class="page-pv">
       Read <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">T-SQL 查询、修改数据表</h1>
  </header>

  <section class="post">
    <p>T-SQL修改表数据 </p>
<p>INSERT语句 </p>
<p>语法： </p>
<p>INSERT<br>[TOP(expression) [PERCENT]]<br>[INTO]<br>{ <object> | rowset_function_limited<br>[ WITH ( &lt;Table_Hint_Limited&gt; [ …n ] ) ] /<em>指定表提示</em>/<br>| view_name } /<em>视图名</em>/<br>{<br>[(column_list) ] /<em>指定列名</em>/<br>[<output clause=""> ]<br>{VALUES /<em>指定列名的取值</em>/<br>{DEFAULT | NULL | expression}[1…n]) /<em>列值的构成形式</em>/<br>|derived_table|execute_statement } }　/<em>结果集</em>/<br>|DEFAULT VALUES　/<em>所有列均取默认值</em>/ </output></object></p>
<p>例子： </p>
<pre><code>/*插入单个元组*/
/*向student表中插入一个学生记录（‘200’，‘曾雷’，‘女’，‘1978-2-3’，‘05001’）*/
USE test            
INSERT INTO student_1 
VALUES(100,&apos;曾雷&apos;,&apos;女&apos;,&apos;1995-2-3&apos;,20)

/*查询student表，查看结果*/
select * from student_1
-----------------------------------------------------------------------------------


/*向student表中插入一个学生记录（‘201’，‘孙浩’，‘男’，‘1977-8-4’，NULL）*/
INSERT INTO student_1(sno,sname,ssex,sbirthday,sage) 
VALUES(200,&apos;孙浩&apos;,&apos;男&apos;,&apos;1996-8-4&apos;,null)

select * from student_1
delete from student_1 where sno=200

INSERT INTO student_1(sno,sname,ssex,sbirthday) 
VALUES(200,&apos;孙浩&apos;,&apos;男&apos;,&apos;1996-8-4&apos;)
-----------------------------------------------------------------------------------


/*插入元组集合*/
/*将student_1表中的相关数据插入到student表中*/
select * from student
select * from student_1

insert into student(sno,sname,ssex,sage)
select sno,sname,ssex,sage 
from student_1 


/*向student表中添加两个新生*/
INSERT INTO student_1(sno,sname,ssex,sbirthday,sage) 
VALUES(300,&apos;王明&apos;,&apos;男&apos;,&apos;1996-8-4&apos;,19),(400,&apos;赵强&apos;,&apos;男&apos;,&apos;1996-4-1&apos;,19)
-----------------------------------------------------------------------------------


/*向自增列添加数据*/
create table testidentity(
id int identity,
words varchar(10))

insert into testidentity values(&apos;a&apos;)  --标识列不指定
insert into testidentity values(&apos;b&apos;)  --指定除了标识列外的列

set IDENTITY_INSERT testidentity on   
insert into testidentity(id,words) values(10,&apos;c&apos;)  --指定标识列

set IDENTITY_INSERT testidentity off  
insert into testidentity values(&apos;d&apos;)

select * from testidentity
</code></pre><p>UPDATE语句 </p>
<p>语法： </p>
<p>UPDATE｛table_name｜view_name｝<br>SET column_name = {expression | DEFAULT | NULL}[1…n]<br>where where_clause </p>
<p>例子： </p>
<pre><code>/*将sc表中的成绩小于60的加5。*/
UPDATE sc
SET grade=grade+5
WHERE grade&lt;70

/*将张三选修1号课程的成绩置零。*/
UPDATE sc
SET grade=0
WHERE cno=1 and sno in
  (select sno from student where sname=&apos;张三&apos;)


/*将学号为1的学生的姓名改为张三十，年龄改小2岁。*/
UPDATE student
SET sname=&apos;张三十&apos;,sage=sage-2   --同时更新多列
WHERE sno=1

select * from student
-----------------------------------------------------------------------------------

/*使用top表达式*/
UPDATE top(2) student
SET sage=sage-2  

UPDATE top(50) percent student
SET sage=sage-2
</code></pre><p>DELETE语句 </p>
<p>语法： </p>
<p>DELETE table_name<br>WHERE search_condition </p>
<p>例子： </p>
<pre><code>/*删除student表中学号为200的记录*/
select * from student
select * from sc

DELETE student  
WHERE sno=&apos;200&apos;

/*删除张三的选修1号课程的选课记录*/
DELETE sc  
WHERE cno=1 and sno in 
    (select sno from student where sname=&apos;张三&apos;)
-----------------------------------------------------------------------------------

/*TRANCATE*/
/*TRUNCATE TABLE  table_name*/
/*一次删除表中所有数据，即清空表，
  但表的结构及约束保持不变，且该操作不记录日志，无法恢复，使用时必须慬慎。*/


/*删除student_1表中的记录*/
TRUNCATE TABLE  student_1

select * from student_1
</code></pre><p>T-SQL查询数据 </p>
<p>SELECT 语句语法： </p>
<p>SELECT select_list<br>[INTO new_table]<br>FROM table_source<br>[WHERE search_condition]<br>[GROUP BY group_by_expression]<br>[HAVING search_condition]<br>[ORDER BY order_expression [ASC | DESC]] </p>
<p>简单查询例子： </p>
<pre><code>/*查询列*/

/*查询student表中所有记录的sname、ssex和sage列*/
SELECT sname,ssex,sage
FROM student

/*查询有选课记录的课程cno*/
select distinct cno   --避免重复项
from sc

/*查询有85分以上成绩的课程cno*/
SELECT DISTINCT cno
FROM  sc 
WHERE grade&gt;85


/*查询student表的所有记录*/
SELECT *
FROM student

SELECT sno as &apos;学号&apos;,sname as &apos;姓名&apos;,ssex as &apos;性别&apos;    
FROM student


/*返回部分结果top*/
select top(1) * from student
select top(1) * from student where ssex=&apos;女&apos;
select top(1) with ties *  from student order by sage
select top(50) percent * from student


/*计算列*/
select sno,sname,2015-sage as &apos;出生年月&apos; from student
select sno,cno,grade*1.1 from sc
-----------------------------------------------------


/*选择查询

查询sc表中成绩大于60的所有记录*/
SELECT *
FROM sc
WHERE grade&gt;60


/*查询sc表中1号课程成绩大于60的所有记录*/
SELECT *
FROM sc
WHERE cno=2 and grade&gt;60


/*查询score表中成绩在60～80之间的所有记录*/
SELECT *
FROM sc
WHERE grade between 60 and 80


/*查询sc表中成绩为85、86或88的记录*/
SELECT *
FROM sc
WHERE grade in(85,86,88)


/*字符串匹配*/

/* % 匹配任意字符
   _ 匹配单个字符
  [] 匹配括号中的任意一个字符
  [^]或[!]匹配没有出现在括号中的单个字符
   escape换码字符  */

select * from student

/*查询student表中姓张的或性别为“女”的学生记录*/
SELECT *
FROM student
WHERE sname like &apos;张%&apos;or ssex=&apos;女&apos;

/*查询student表中姓李的学生*/
SELECT *
FROM student
WHERE sname like &apos;李%&apos;

SELECT *
FROM student
WHERE sname like &apos;[李]%&apos;

SELECT *
FROM student
WHERE sname like &apos;李_&apos;

SELECT *
FROM student
WHERE sname like &apos;[^李]%&apos;

SELECT *
FROM student
WHERE sname not like &apos;[李]%&apos;

SELECT *
FROM student
WHERE sname like &apos;%[四]%&apos;


/*查询sc表中没成绩的记录*/
SELECT *
FROM sc
WHERE grade is null

SELECT *
FROM sc
WHERE grade is not null


/*查询结果排序*/
SELECT *
FROM sc
order by grade 

SELECT *
FROM sc
order by cno,grade desc


/*分组查询*/
/*group by group_by_expression[with rollup|cube]*
  having search_condition
  with rollup 只返回第一个分组条件制定的列的统计行;
  而with cube除返回group by制定的列外,还返回按组统计的行*/

SELECT cno,AVG(grade)
FROM sc
group by cno

SELECT cno,AVG(grade)
FROM sc
group by cno
having AVG(grade)&gt;60

SELECT cno,tno,AVG(grade)
FROM sc
group by cno,tno

SELECT cno,tno,AVG(grade)
FROM sc
group by cno,tno with rollup

select AVG(grade)
from sc
</code></pre><p>高级查询例子： </p>
<pre><code>/*嵌套查询*/
use test

/*使用IN或NOT IN*/
select sname
from student
where sno in
    (select sno 
     from sc
     where cno=2)

select sname
from student
where sno not in
    (select sno 
     from sc
     where cno=2)


/*比较运算符的子查询*/

select sno,grade
from sc sc1
where sc1.cno=1 and 
    sc1.grade=(select sc2.grade 
                from sc sc2 
                where sc2.cno=1 and sc2.sno=1)

select * from sc

select sno,grade
from sc sc1
where sc1.cno=1 and 
    sc1.grade&gt;(select sc2.grade 
                from sc sc2 
                where sc2.cno=1 and sc2.sno=1)

select sno
from sc 
where cno=1 and 
      grade&gt;all(select grade from sc where sno=1)

select sno
from sc 
where cno=1 and 
      grade&gt;(select max(grade) from sc where sno=1)


select student.sno,sname,cno,grade
from sc as a,student
where student.sno=a.sno and  --不相关子查询
    grade&gt;(select avg(grade)
           from sc b
           where b.cno=a.cno)  


/*exists*/
SELECT sname
FROM student 
WHERE EXISTS
 (SELECT *
  FROM sc
  WHERE student.sno=sc.sno and sc.cno=2)

SELECT sname
FROM student 
WHERE not EXISTS
 (SELECT *
  FROM sc
  WHERE student.sno=sc.sno and sc.cno=2)


/*多层嵌套查询
查询最高分的学生姓名*/

select *
from student
where not exists
    (select * 
     from course
     where not exists
        (select * 
         from sc
         where sc.sno=student.sno and sc.cno=course.cno))


select sname
from student
where sno in
    (select sno
     from sc
     where  grade=
        (select max(grade)
        from sc))
go

select * from sc
select * from student


/*DELETE、UPDATE和INSERT语句中的子查询*/
------------------------------------------------------------


/*联接查询*/
use test

/*查询学生的姓名，选课号及成绩*/

select sname,cno,grade
from student,sc 
where student.sno=sc.sno

select sname,cname,grade 
from student,sc,course  --多表连接
where student.sno=sc.sno and sc.cno=course.cno

select sname,cno,grade
from student inner join sc on(student.sno=sc.sno) --内连接


select student.sname,sc.cno,sc.grade
from student left join sc on (student.sno=sc.sno)  --左向外连接


select student.sname,sc.cno,sc.grade
from student right join sc on (student.sno=sc.sno)   --右向外连接


select student.sname,sc.cno,sc.grade
from student full outer join sc on (student.sno=sc.sno)  --完全外部连接


select student.sno,sc.sno,sc.cno,sc.grade  
from student cross join sc                  --交叉连接

select student.sno,sc.sno,sc.cno,sc.grade  
from student cross join sc                  --带限定条件的交叉连接
where student.sno&lt;2


select c1.cno,c2.cname
from course c1,course c2    --自连接
where c1.cpno=c2.cno
--------------------------------------------------------------------------

/*无法使用ntext、text或image列上直接连接表，
但是使用substring函数在ntext、text或image列上间接联接表，如*/

select *
from student join sc
on substring(student.mytext,1,2)=substring(sc.mytext,1,2)
------------------------------


/*使用UNION运算符组合多个结果
查询所有作者和客户的号码和名称*/

select sno,sname from student where sno=1
union
select sno,sname from student where sno=2
go
---------------------------

 /*在查询的基础上创建新表
将查询得到的学生学号、姓名、课程和分数输入到新建的表score1中，
再显示该新表的记录*/

select student.sno,avg(grade) as 平均成绩
into avggrade    --该表自动生成
from student inner join sc on (student.sno=sc.sno)
group by student.sno

select * from avggrade


drop table avggrade
</code></pre><p><a href="http://www.cnblogs.com/z941030/" target="_blank" rel="noopener"> 博客园博客:欠扁的小篮子 </a>   </p>

  </section>

</article>

<section class="read-more">
           
    
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Newer Post</span>
                <h2 class="post-list__post-title post-title"><a href="/2016/03/03/sql server 触发器/" title="sql server 触发器">sql server 触发器</a></h2>
                <p class="excerpt">
                
                触发器  是一种特殊类型的存储过程。触发器可包含复杂的T-SQL语句。触发器不能通过名称被直接调用，也不允许设置参数。它是建立在触发事件上的。 
触发器可以强制执行一定的业务规则，以保持数据完整性、检查数据有效性、实现数据库管理任务和一些附加功能。 
触发器的分类：  DML、 DDL、 登录触发器
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2016-03-03T14:56:27.000Z" class="post-list__meta--date date">2016-03-03</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/2016/03/03/sql server 触发器/">继续阅读</a></div>
                           
            </div>
        
        
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Older Post</span>
                <h2 class="post-list__post-title post-title"><a href="/2016/02/18/sql server 事务处理/" title="sql server 事务处理">sql server 事务处理</a></h2>
                <p class="excerpt">
                
                事物处理 
事务是SQL Server中的单个逻辑单元，一个事务内的所有SQL语句作为一个整体执行，要么全部执行，要么都不执行。 
事务有4个属性，称为ACID（原子性、一致性、隔离性和持久性） 
原子性  事务必须是原子工作单元。对于其数据修改，要么全都执行，要么全都不执行。 
一致性  事务在完
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2016-02-18T13:26:15.000Z" class="post-list__meta--date date">2016-02-18</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/2016/02/18/sql server 事务处理/">继续阅读</a></div>
                       
            </div>
        
     
   
   
  
</section>

  

            <footer class="footer">
    <span class="footer__copyright">
        &copy; 2019 sage wong - 本站点采用 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
       
    </span>
    <span class="footer__copyright">
             - 基于 <a href="http://hexo.io">Hexo</a> 搭建，使用 <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> 主题，由<a href="https://monniya.com ">@Monniya</a> 修改自 <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, 原创出自<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
         </span>
       
    
    
</footer>


        </div>
    </div>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-78918255-1', 'auto');
	ga('send', 'pageview');
</script>

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?9cdad07c755fa23f6aced510c6760e87";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
</body>
</html>
